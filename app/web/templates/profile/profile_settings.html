{% extends "base.html" %}

{% block title %}–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é ‚Äî LinguaPro{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/profile/profile_settings.css') }}">
{% endblock %}

{% block content %}

<section class="settings-container container">

    <h1 class="settings-title">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</h1>
    <p class="settings-subtitle">
        –ö–µ—Ä—É–π—Ç–µ –æ—Å–æ–±–∏—Å—Ç–∏–º–∏ –¥–∞–Ω–∏–º–∏, –±–µ–∑–ø–µ–∫–æ—é —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º –≤–∏–≥–ª—è–¥–æ–º –≤–∞—à–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É.
    </p>

    <!-- –û–°–û–ë–ò–°–¢–Ü –î–ê–ù–Ü -->
    <div class="settings-block premium-profile">

        <h2>üë§ –û—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ</h2>
        <p class="block-desc">–û–Ω–æ–≤—ñ—Ç—å –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤–∞—à–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é</p>

        <form method="POST" action="/settings/update_profile" class="settings-form premium-form">

            <div class="premium-row">
                <div class="premium-group">
                    <label>–Ü–º‚Äô—è</label>
                    <input type="text" name="name" value="{{ user.name }}" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è">
                </div>

                <div class="premium-group">
                    <label>–ü—Ä—ñ–∑–≤–∏—â–µ</label>
                    <input type="text" name="surname" value="{{ user.surname }}" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø—Ä—ñ–∑–≤–∏—â–µ">
                </div>
            </div>

            <div class="premium-group">
                <label>–ù—ñ–∫–Ω–µ–π–º</label>
                <input type="text" name="username" value="{{ user.username or '' }}" placeholder="@username">
            </div>

            <div class="premium-group">
                <label>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</label>

                <div class="premium-birth">

                    <select name="birth_day" class="premium-select">
                        <option value="">–î–µ–Ω—å</option>
                        {% for day in range(1, 32) %}
                        <option value="{{ day }}"
                                {% if user.birth_date and user.birth_date.day== day %}selected{% endif %}>
                            {{ day }}
                        </option>
                        {% endfor %}
                    </select>

                    <select name="birth_month" class="premium-select">
                        <option value="">–ú—ñ—Å—è—Ü—å</option>
                        {% set months = [
                        ('1','–°—ñ—á–µ–Ω—å'), ('2','–õ—é—Ç–∏–π'), ('3','–ë–µ—Ä–µ–∑–µ–Ω—å'),
                        ('4','–ö–≤—ñ—Ç–µ–Ω—å'), ('5','–¢—Ä–∞–≤–µ–Ω—å'), ('6','–ß–µ—Ä–≤–µ–Ω—å'),
                        ('7','–õ–∏–ø–µ–Ω—å'), ('8','–°–µ—Ä–ø–µ–Ω—å'),
                        ('9','–í–µ—Ä–µ—Å–µ–Ω—å'), ('10','–ñ–æ–≤—Ç–µ–Ω—å'),
                        ('11','–õ–∏—Å—Ç–æ–ø–∞–¥'), ('12','–ì—Ä—É–¥–µ–Ω—å')
                        ] %}

                        {% for val, label in months %}
                        <option value="{{ val }}"
                                {% if user.birth_date and user.birth_date.month== val|int %}selected{% endif %}>
                            {{ label }}
                        </option>
                        {% endfor %}
                    </select>

                    <select name="birth_year" class="premium-select">
                        <option value="">–†—ñ–∫</option>
                        {% for y in range(1950, 2026) %}
                        <option value="{{ y }}"
                                {% if user.birth_date and user.birth_date.year== y %}selected{% endif %}>
                            {{ y }}
                        </option>
                        {% endfor %}
                    </select>

                </div>
            </div>

            <button class="premium-save-btn">
                üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
            </button>

        </form>
    </div>


    <!-- –ê–í–ê–¢–ê–† -->
    <div class="settings-block" id="avatar">
        <h2>üñºÔ∏è –§–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é</h2>

        <div class="avatar-modern">

            <div class="avatar-preview">
                <img src="{% if user.avatar %}
                            {{ url_for('static', path='media/avatars/' + user.avatar.file_path) }}
                        {% else %}
                            {{ url_for('static', path='media/content/default-avatar.png') }}
                        {% endif %}"
                     class="profile-avatar">
            </div>

            <form action="/settings/upload_avatar" method="POST" enctype="multipart/form-data" class="avatar-controls">

                <label for="avatarInput" class="avatar-upload-btn">
                    üì∑ –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ
                </label>

                <input type="file" id="avatarInput" name="avatar" accept="image/*">

                <button class="btn save-avatar-btn">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </form>

        </div>
    </div>


    <!-- –ë–ï–ó–ü–ï–ö–ê -->
    <div class="settings-block premium-security" id="security">
        <h2>üîí –ë–µ–∑–ø–µ–∫–∞</h2>

        <form method="POST" action="/settings/change_password" class="settings-form premium-form">

            <div class="premium-group">
                <label>–°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å</label>
                <input type="password" name="old_password" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å">
            </div>

            <div class="premium-group">
                <label>–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å</label>
                <input type="password" name="new_password" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å">
            </div>

            <div class="security-premium-actions">
                <button class="premium-btn">
                    üîê –ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å
                </button>

                <button type="button"
                        class="forgot-password-premium"
                        id="forgotPasswordBtn">
                    –ó–∞–±—É–ª–∏ –ø–∞—Ä–æ–ª—å?
                </button>
            </div>
            {% if request.query_params.get('error') == 'wrong_password' %}
            <p class="password-error-message danger">
                ‚ùå –°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å –≤–≤–µ–¥–µ–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
            </p>
            {% endif %}

            {% if request.query_params.get('error') == 'no_password' %}
            <p class="password-error-message warning">
                ‚ö†Ô∏è –¶–µ–π –∞–∫–∞—É–Ω—Ç –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ Google. –ü–∞—Ä–æ–ª—å –≤—ñ–¥—Å—É—Ç–Ω—ñ–π.
            </p>
            {% endif %}

            {% if request.query_params.get('success') == 'password_changed' %}
            <p class="success-message">
                ‚úÖ –ü–∞—Ä–æ–ª—å —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ
            </p>
            {% endif %}


            <div class="forgot-success-message premium-success" id="forgotSuccessMessage">
                ‚úÖ –ú–∏ –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ –ª–∏—Å—Ç –Ω–∞ –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –¥–ª—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è
            </div>

        </form>
    </div>


</section>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', path='/js/profile/profile_settings.js') }}"></script>
{% endblock %}
