{% extends "base.html" %}

{% block title %}–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å ‚Äî LinguaPro{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/profile.css') }}">
{% endblock %}

{% block content %}
<section class="profile-container">
    {% if user %}
    <div class="profile-card">
        <!-- –ê–≤–∞—Ç–∞—Ä -->
        <div class="avatar-section">
            {% if user.avatar and user.avatar.file_path %}
            <img src="{{ url_for('static', path='media/avatars/' + user.avatar.file_path) }}" alt="–ê–≤–∞—Ç–∞—Ä"
                 class="avatar">
            {% else %}
            <img src="{{ url_for('static', path='media/content/default-avatar.png') }}" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar">
            {% endif %}
            <label for="avatar" class="upload-label">üì∑ –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ</label>
            <input type="file" id="avatar" name="avatar" accept="image/*" form="profileForm" style="display: none;">
        </div>

        <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
        <form id="profileForm" method="post" action="/profile" enctype="multipart/form-data" class="profile-form">
            <div class="form-group">
                <label for="name">–Ü–º‚Äô—è</label>
                <input type="text" id="name" name="name" value="{{ user.name or '' }}">
            </div>

            <div class="form-group">
                <label for="surname">–ü—Ä—ñ–∑–≤–∏—â–µ</label>
                <input type="text" id="surname" name="surname" value="{{ user.surname or '' }}">
            </div>

            <div class="form-group">
                <label for="username">–ù—ñ–∫</label>
                <input type="text" id="username" name="username" value="{{ user.username or '' }}">
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" value="{{ user.email }}" readonly class="readonly">
                <small>Email –Ω–µ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏</small>
            </div>

            <div class="form-group">
                <label>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</label>

                <div class="birth-date-selects">
                    <select id="birth_day" name="birth_day" class="modern-select" required>
                        <option value="">–î–µ–Ω—å</option>
                        {% for day in range(1,32) %}
                        <option value="{{ day }}"
                                {% if user.birth_date and user.birth_date.day== day %} selected {% endif %}>
                            {{ day }}
                        </option>
                        {% endfor %}
                    </select>

                    <select id="birth_month" name="birth_month" class="modern-select" required>
                        <option value="">–ú—ñ—Å—è—Ü—å</option>
                        {% set months = [
                        ('1','–°—ñ—á–µ–Ω—å'),('2','–õ—é—Ç–∏–π'),('3','–ë–µ—Ä–µ–∑–µ–Ω—å'),('4','–ö–≤—ñ—Ç–µ–Ω—å'),
                        ('5','–¢—Ä–∞–≤–µ–Ω—å'),('6','–ß–µ—Ä–≤–µ–Ω—å'),('7','–õ–∏–ø–µ–Ω—å'),('8','–°–µ—Ä–ø–µ–Ω—å'),
                        ('9','–í–µ—Ä–µ—Å–µ–Ω—å'),('10','–ñ–æ–≤—Ç–µ–Ω—å'),('11','–õ–∏—Å—Ç–æ–ø–∞–¥'),('12','–ì—Ä—É–¥–µ–Ω—å')
                        ] %}
                        {% for val, label in months %}
                        <option value="{{ val }}"
                                {% if user.birth_date and user.birth_date.month== val|int %} selected {% endif %}>
                            {{ label }}
                        </option>
                        {% endfor %}
                    </select>

                    <select id="birth_year" name="birth_year" class="modern-select" required>
                        <option value="">–†—ñ–∫</option>
                        {% for year in range(1950, 2026) %}
                        <option value="{{ year }}"
                                {% if user.birth_date and user.birth_date.year== year %} selected {% endif %}>
                            {{ year }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <button type="submit" class="btn save-btn">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
        </form>

        {% if message %}
        <p class="message success">{{ message }}</p>
        {% endif %}
        {% if error %}
        <p class="message error">{{ error }}</p>
        {% endif %}
    </div>

    {% else %}
    <p class="message error">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π</p>
    {% endif %}
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', path='/js/profile.js') }}"></script>
{% endblock %}
